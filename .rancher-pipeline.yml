stages:
- name: Build something
  steps:
  - runScriptConfig:
      image: busybox
      shellScript: date -R
  when:
    branch:
      include:
      - master
    event: {}
- name: Publish my image
  steps:
  - publishImageConfig:
      dockerfilePath: ./Dockerfile
      buildContext: .
      tag: ichetanbhatt/test-repo:latest
      pushRemote: true
      registry: index.docker.io
- name: Redeploy
  steps:
  - runScriptConfig:
      image: python:latest
      shellScript: |-
        curl -u "token-8xg66:qbk8qhxnq6ndd4sddj7qbqq26ppbt28jlmggvbhkh4vn56786pdklc" \
        -X POST \
        -H 'Accept: application/json' \
        -H 'Content-Type: application/json' \
        'https://localhost:8443/v3/project/c-7h54t:p-97484/workloads/deployment:dev:hello-world?action=redeploy'
notification: {}
